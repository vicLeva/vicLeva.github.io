## Themisto: a scalable colored k-mer index for sensitive pseudoalignment against hundreds of thousands of bacterial genomes - 2023

[LINK](https://drops.dagstuhl.de/opus/volltexte/2023/18644/) 

### Authors  
Jarno N Alanko, Jaakko Vuohtoniemi, Tommi Mäklin, Simon J Puglisi

### Résumé

#### En 2 lignes

software complet d'indexation + pseudoalignement implémentant plusieurs structures de données. database représentée via cdBG, kmers encodés via spectral BWT et stratégies différentes de compression des couleurs. Enfin mapping kmer -> couleur 

#### Préliminaires

pseudoalignement : kmer belongs or not ? alignement : where is kmer located in genomic dataset ?\
SOTA : 
  + Bifrost-2020, Metagraph-2020 search for all kmers of the query if present in database index and if 80%+ are present : positive
  + (Kallisto-2016, original pseudoalignement). idem with 100%. stocks each kmer's colors in index and does intersection of all kmers colors sets

kmers absolument pas retrouvés dans l'index d'aucun dataset -> erreurs de seq ou artefacts de seq (adaptateur? barcode?) donc ne doivent pas impacter le seuil de sensibilité de la query 



#### Méthodes

GGCAT-2022 to build unitigs (cdBG)

2-part structure
  + Set of distinct kmers encoded with Spectral Burrows Wheeler Transform (SBWT), variante de la BWT utilisée par BOSS-2012 -> kmers in D (dataset)\
  + bitmap or int array pour encoder les colors de chaque kmer (selon le + petit dans la situation)\ 
Lorsqu'un dataset est sparse, stockage des "key k-mers" pour condenser l'information. Les key kmers sont les kmers en debut et fin de ref + ceux qui sont en fin d'unitig. On peut donc obtenir la couleur d'un noeud en parcourant le graph jusqu'a tomber sur un noeud \<key kmer\>


pseudoalignement : hybride entre kallisto et bifrost/metagraph : seuil flexible + omission des kmers présents dans aucune ref du dataset

#### Résultats

Surpasse Bifrost & Metagraph mais [fulgor]({% post_url 2023-10-09-fulgor %}) présente meilleurs résultat mtnt

