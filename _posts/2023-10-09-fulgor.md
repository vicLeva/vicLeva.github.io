## Fulgor: A Fast and Compact *k*-mer Index for Large-Scale Matching and Color Queries - 2023

[LINK](https://drops.dagstuhl.de/opus/volltexte/2023/18644/) 

### Authors  
Fan, Jason and Singh, Noor Pratap and Khan, Jamshed and Pibiri, Giulio Ermanno and Patro, Rob

### Résumé

#### Préliminaires

*Color*(x) = ensemble des références dans lesquelles le kmer x apparaît. 1 référence = 1 string dans {A, T, C, G}, un génome par exemple.

L'index serait la structure qui permet de trouver *Color*(x) pour chaque kmer x existant. (avec x plus petit que les références ofc)

Idée de base : **inverted index** + dict pour avoir x -> *Color*(x)\
Un index *L* va contenir *Color*(x) pour chaque kmer de toutes les références disponibles.\
Un dictionnaire *D* va contenir tous les kmers distincts (n en tout). Ce dictionnaire supporte *Lookup*(x), qui retourne false if x not found et sinon un id unique dans {1,...,n}.\
*Lookup*(x) donnera donc normalement l'adresse de *Color*(x) dans l'index, permettant de retrouver le format compressé des références recherchées. 

Usage de **ccdBG** :\
**de Bruijn Graph** : graphe qui possède des kmers en tant que noeuds et une arête entre 2 noeuds si ces 2 kmers (noeuds) partagent k-1 nucléotides.\
**compacted de Bruijn Graph** : dBG où une suite de plusieurs noeuds consécutifs (sans branchement extérieur) est concaténée pour obtenir un unitig (=1 noeud contenant un string + long qu'un simple kmer).\
**colored compacted de Bruijn Graph** : cdBG où chaque noeud accueille en plus l'info de *Color*(x). (un unitig est monochromatique -> tous les kmers le constituant partagent les memes couleurs)

*ColorID*(u) = couleur de l'unitig u

#### L'index de Fulgor

![figure 1](/vicleva.github.io/assets/fulgor1.png)
A schematic picture of the index described in Section 3, highlighting the interplay between the k-mer dictionary D, the bit-vector B, and the inverted index L. The red arrows show how the index is queried for a k-mer x, assuming that x occurs in unitig u6 and has color C3. The k-mer x is first mapped by D to its unitig u6 via the query *UnitigID*(x) = 6. Then we compute *ColorID*(u6) = *Rank1*(6, B) + 1 = 2 + 1 = 3 and lastly retrieve C3 from L


