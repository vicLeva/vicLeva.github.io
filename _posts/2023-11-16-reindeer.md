## REINDEER: efficient indexing of k-mer presence and abundance in sequencing datasets - 2020

[LINK](https://academic.oup.com/bioinformatics/article/36/Supplement_1/i177/5870500?login=true) 

### Authors  
Camille Marchet, Zamin Iqbal, Daniel Gautheret, Mikaël Salson and Rayan Chikhi

### Résumé

#### En 2 lignes


#### Préliminaires

**De Bruijn Graph** : graphe orienté où les sommets sont des kmers et il y a un arc entre les kmers u et v si u et v se chevauchent sur k-1 nucleotides.

**Unipath** : Plus longue série possible de kmers se chevauchant, et ayant tous des degrés in et out = 1 (sans autre embranchement)

**Unitig** : premier kmer d’un Unipath auquel au concatène les nucleotides additionnels des kmers suivants.

**Compacted DBG** : DBG où les sommets sont des unitigs (donc taille sommet ≥ k)

**SPSS** : façon de représenter un set de kmers sous une forme + compact, permettant quand même de retrouver l’info de tous les kmers distincts

#### Méthodes


build reindeer
1. For each dataset, build an individual DBG that also records k-mer counts, averaged per unitig. **Use BCALM2** (Chikhi et al., 2016)

2. Construct monotigs  to index all k-mers from the union DBG of all datasets.
(A monotig is the sequence of a path in the union DBG in which all constituent k-mers have the same count-vector and the same minimizer)  
**Use modified Blight for index**

3. Associate count-vectors to monotigs, and further discard duplicated count-vectors.  
(count vector : for a kmer/monotig : son compte d’abondances dans chaque dataset  
→ une case = un compte dans un dataset)

query : chaque kmer de la query est converti en un monotig id permettant de consulter le count associé dans la matrix de count-vectors.  
Si tous les counts sont egaux, on retourne cette value, sinon un tuple des values possibles


**discretization of counts** : permet de sacrifier des bits de poids faibles pour un gain d’espace au moment de sauvegarder les counts.   
github.com/GATB/gatb-core/blob/f58d96b/gatb-core/src/gatb/tools/collections/impl/MapMPHF.hpp#L85  
jeu dangereux car peut avoir un impact non désiré sur de l’analyse différentielle par exemple
